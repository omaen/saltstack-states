{% import_yaml 'filebeat/defaults.yaml' as defaults %}

{% set os_family_map = salt['grains.filter_by']({
    'Debian': {
      'package': 'filebeat',
      'service': 'filebeat'
    },
  }, grain='os_family', merge=salt['pillar.get']('filebeat:lookup'))
%}

{% do defaults.filebeat.update(os_family_map) %}

{% set filebeat = salt['pillar.get'](
  'filebeat',
  default=defaults.filebeat,
  merge=True)
%}
